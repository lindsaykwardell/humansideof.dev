---
import DefaultLayout from "../../layouts/DefaultLayout.astro";
import BlogPost from "../../components/BlogPost.astro";
import Lindsay from "@/components/Lindsay.astro";
import { getEntry } from "astro:content";

const { slug } = Astro.params as { slug: string };

const post = await getEntry("blog", slug);

if (!post || (!post.data.published && !import.meta.env.DEV))
  throw new Error(`Post not found: ${slug}`);

const title: string = post.data.title;
const author: string = post.data.author;
const description: string = post.data.description;
const canonical_url: string = post.data.canonical_url;
---

<DefaultLayout
  title={`${title} by ${author}`}
  permalink={canonical_url}
  description={description}
>
  <BlogPost post={post} />
  <div class="pt-4">
    <hr class="w-11/12 m-auto" />
    <Lindsay />
  </div>
</DefaultLayout>
